(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{100:function(e,t,n){e.exports=n(129)},129:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),l=n.n(c),u=n(11),o=n(174),i=(n(60),n(6)),s=n.n(i),m=n(13),f=n(24),d=n(15),p=n(28),E=n(91),b=n(27),v=n.n(b),g="/api/blogs",O=null,h={getAll:function(){return v.a.get(g).then((function(e){return e.data}))},create:function(){var e=Object(m.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.next=3,v.a.post(g,t,n);case 3:return a=e.sent,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){O="bearer ".concat(e)},update:function(){var e=Object(m.a)(s.a.mark((function e(t,n){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.put("".concat(g,"/").concat(t),n);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:O}},e.abrupt("return",v.a.delete("".concat(g,"/").concat(t),n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:function(){var e=Object(m.a)(s.a.mark((function e(t,n){var a,r,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={headers:{Authorization:O}},r={content:n},e.next=4,v.a.post("".concat(g,"/").concat(t,"/comments"),r,a);case 4:return c=e.sent,e.abrupt("return",c.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},y=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.deleteBlog(e);case 2:t.sent,n({type:"DELETE_BLOG",data:e});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},j=function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Object(p.a)(Object(p.a)({},e),{},{likes:e.likes+1}),t.next=3,h.update(e.id,a);case 3:t.sent,n({type:"LIKE_BLOG",data:e.id});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.data;case"NEW_BLOG":return[].concat(Object(E.a)(e),[t.data]);case"DELETE_BLOG":return e.filter((function(e){return e.id!==t.data}));case"LIKE_BLOG":var n=e.findIndex((function(e){return e.id===t.data}));return e.map((function(e,t){return t!==n?e:Object(p.a)(Object(p.a)({},e),{},{likes:e.likes+1})}));case"ADD_COMMENT":var a=e.find((function(e){return e.id===t.id})),r=Object(p.a)(Object(p.a)({},a),{},{comments:t.data});return e.map((function(e){return e.id===t.id?r:e}));default:return e}},T=function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(a){var r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a({type:"SET_NOTIFICATION",notifMessage:e,notifType:t}),n.next=3,setTimeout((function(){a({type:"REMOVE_NOTIFICATION"})}),5e3);case 3:r=n.sent,a({type:"REFRESH_TIMEOUT",timeoutID:r});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{notifMessage:null,notifType:null,timeoutID:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return e.timeoutID&&clearTimeout(e.timeoutID),{notifMessage:t.notifMessage,notifType:t.notifType,timeoutID:null};case"REMOVE_NOTIFICATION":return{notifMessage:null,notifType:null,timeoutID:null};case"REFRESH_TIMEOUT":return Object(p.a)(Object(p.a)({},e),{},{timeoutID:t.timeoutID});default:return e}},x=function(e){return{type:"SET_USER",user:e}},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return t.user;case"LOGOUT":return null;default:return e}},S=function(){return v.a.get("/api/users").then((function(e){return e.data}))},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.payload;default:return e}},N=n(21),D=n(177),C=n(161),B=function(e){var t=Object(a.useState)(!1),n=Object(N.a)(t,2),c=n[0],l=n[1],u={display:c?"none":""},o={display:c?"":"none"},i=function(){l(!c)};return r.a.createElement(D.a,{py:3},r.a.createElement("div",{style:u},r.a.createElement(C.a,{variant:"contained",color:"primary",onClick:i},e.openLabel)),r.a.createElement("div",{style:o},e.children,r.a.createElement(C.a,{variant:"contained",color:"secondary",onClick:i},e.closeLabel)))},_=n(46),U=n(3),M=function(e){var t=e.blog,n=Object(a.useState)(""),c=Object(N.a)(n,2),l=c[0],o=c[1],i=Object(u.b)();return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i(function(e,t){return function(){var n=Object(m.a)(s.a.mark((function n(a){var r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,h.addComment(e.id,t);case 2:r=n.sent,a({type:"ADD_COMMENT",id:e.id,data:r.comments});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,l)),o("")}},r.a.createElement("input",{type:"text",value:l,name:"Comment",onChange:function(e){return o(e.target.value)}}),r.a.createElement("button",{type:"submit"},"add comment")))},A=function(e){var t=e.blog;return r.a.createElement("div",null,r.a.createElement(M,{blog:t}),r.a.createElement("ul",null,t.comments.map((function(e,t){return r.a.createElement("li",{key:t},e)}))))},G=n(163),R=n(164),W=n(165),z=n(180),q=n(166),F=n(167),H=n(50),J=n(168),K=n(169),V=n(87),P=n.n(V),Q=n(86),X=n.n(Q),Y=function(e){var t,n=e.blog,c=Object(a.useState)(!1),l=Object(N.a)(c,2),o=l[0],i=l[1],f=Object(u.c)((function(e){return e.signedinUser})),p=Object(u.b)(),E=Object(d.f)(),b=function(){var e=Object(m.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),p(j(n));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v=function(){var e=Object(m.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("delete ".concat(n,"?"))?(p(y(t)),E.push("/blogs"),p(T("BLOG ".concat(n," HAS BEEN DELETED"),"success"))):console.log("cancelled delete");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return f&&n?r.a.createElement(G.a,null,r.a.createElement(R.a,{elevation:6,className:"blogpostCard"},r.a.createElement(W.a,{avatar:r.a.createElement(z.a,null,n.author[0]),title:n.title,subheader:n.author,action:r.a.createElement(q.a,{onClick:function(){return v(n.id,n.title)},style:n?f.id!==n.user.id?{display:"none"}:void 0:{display:"none"}},r.a.createElement(X.a,{color:"secondary"}))}),r.a.createElement(F.a,null,r.a.createElement(H.a,{variant:"subtitle2",component:"a",href:n.url},n.url),r.a.createElement(H.a,{variant:"body1",component:"p"},n.likes," likes"),r.a.createElement(C.a,{variant:"contained",color:"primary",onClick:function(e){return b(e)}},"LIKE")),r.a.createElement(J.a,null,r.a.createElement("h2",null,"comments"),r.a.createElement(q.a,{className:Object(U.a)((t={},Object(_.a)(t,"cardexpandButton",!o),Object(_.a)(t,"cardexpandButtonOpen",o),t)),onClick:function(){i(!o)},"aria-expanded":o,"aria-label":"show more"},r.a.createElement(P.a,null))),r.a.createElement(K.a,{in:o,timeout:"auto",unmountOnExit:!0},r.a.createElement(F.a,null,r.a.createElement(A,{blog:n}))))):r.a.createElement("h1",null,"loading...")},Z=n(90),$=n(175),ee=(Object(Z.a)({}),function(){var e=Object(a.useState)(""),t=Object(N.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(""),o=Object(N.a)(l,2),i=o[0],f=o[1],d=Object(a.useState)(""),p=Object(N.a)(d,2),E=p[0],b=p[1],v=Object(u.b)();return r.a.createElement("div",null,r.a.createElement("h1",null,"create new"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),console.log("sending:",n,i,E);var t={title:n,author:i,url:E};c(""),f(""),b(""),v(function(e){return function(){var t=Object(m.a)(s.a.mark((function t(n){var a;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.create(e);case 2:a=t.sent,n({type:"NEW_BLOG",data:a});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(t)),v(T("A NEW BLOG ".concat(t.title," by ").concat(t.author," HAS BEEN ADDED"),"success"))}},r.a.createElement("div",null,r.a.createElement($.a,{value:n,onChange:function(e){return c(e.target.value)},variant:"outlined",label:"Title",size:"small",margin:"dense",required:!0})),r.a.createElement("div",null,r.a.createElement($.a,{value:i,onChange:function(e){return f(e.target.value)},variant:"outlined",label:"Author",size:"small",margin:"dense",required:!0})),r.a.createElement("div",null,r.a.createElement($.a,{value:E,onChange:function(e){return b(e.target.value)},variant:"outlined",label:"URL",size:"small",margin:"dense",required:!0})),r.a.createElement(C.a,{id:"createBlog-button",type:"submit",variant:"contained",color:"primary"},"create")))}),te=function(){var e=Object(u.c)((function(e){return e.blogs})),t=Object(d.g)("/blogs/:id"),n=t?e.find((function(e){return e.id===t.params.id})):null;return r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/blogs/:id"},r.a.createElement(Y,{blog:n})),r.a.createElement(d.a,{path:"/blogs"},r.a.createElement("h1",null,"blogs"),r.a.createElement(B,{openLabel:"new blog",closeLabel:"cancel"},r.a.createElement(D.a,null,r.a.createElement(ee,null))),r.a.createElement("div",{className:"allBlogs"},e.map((function(e){return r.a.createElement(R.a,{className:"bloglistCard",elevation:3,square:"true",key:e.id},r.a.createElement(F.a,null,r.a.createElement(f.b,{to:"/blogs/".concat(e.id)},e.title," - ",e.author)))})))))},ne={login:function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},ae=n(93),re=function(){var e=Object(a.useState)(""),t=Object(N.a)(e,2),n=t[0],c=t[1],l=Object(a.useState)(""),o=Object(N.a)(l,2),i=o[0],f=o[1],d=Object(u.b)(),p=function(){var e=Object(m.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),console.log("logging in:",n,i),e.prev=2,e.next=5,ne.login({username:n,password:i});case 5:a=e.sent,window.localStorage.setItem("loggedUser",JSON.stringify(a)),h.setToken(a.token),d(x(a)),c(""),f(""),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),console.log("handleLogin",e.t0),d(k("wrong username or password","error"));case 17:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(G.a,{maxWidth:"sm"},r.a.createElement(ae.a,{elevation:3},r.a.createElement(D.a,{padding:6},r.a.createElement("form",{onSubmit:p},r.a.createElement("h1",null,"Hello."),r.a.createElement("div",null,r.a.createElement($.a,{id:"username-input",type:"text",value:n,label:"Username",variant:"outlined",margin:"normal",fullWidth:!0,required:!0,onChange:function(e){return c(e.target.value)}})),r.a.createElement("div",null,r.a.createElement($.a,{id:"password-input",type:"password",value:i,label:"Password",variant:"outlined",margin:"normal",fullWidth:!0,required:!0,onChange:function(e){return f(e.target.value)}})),r.a.createElement(C.a,{variant:"contained",color:"primary",id:"login-button",type:"submit",fullWidth:!0},"login")))))},ce=n(179),le=n(170),ue=function(){var e=Object(u.c)((function(e){return e.notification}));return null===e.notifMessage?null:"success"===e.notifType?r.a.createElement(ce.a,{severity:"success"},r.a.createElement(le.a,null,"Success!"),e.notifMessage):"error"===e.notifType?r.a.createElement(ce.a,{severity:"error"},r.a.createElement(le.a,null,"Error!"),e.notifMessage):void 0},oe=function(){var e=Object(u.c)((function(e){return e.users}));return r.a.createElement("div",null,r.a.createElement("h1",null,"Users"),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null),r.a.createElement("th",null,r.a.createElement("strong",null,"blogs created")))),r.a.createElement("tbody",null,e.map((function(e){return r.a.createElement("tr",{key:e.id},r.a.createElement("td",null,r.a.createElement(f.b,{to:"/users/".concat(e.id)},e.name)),r.a.createElement("td",null,e.blogs.length))})))))},ie=function(e){var t=e.user;return t?r.a.createElement("div",null,r.a.createElement("h1",null,t.name),r.a.createElement("h2",null,"added blogs"),r.a.createElement("ul",null,t.blogs.map((function(e){return r.a.createElement("li",{key:e.id},e.title)})))):r.a.createElement("div",null,"loading...")},se=function(){var e=Object(u.c)((function(e){return e.users})),t=Object(d.g)("/users/:id"),n=t?e.find((function(e){return e.id===t.params.id})):null;return r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/users/:id"},r.a.createElement(ie,{user:n})),r.a.createElement(d.a,{path:"/users/"},r.a.createElement(oe,null)))},me=n(171),fe=n(172),de=n(178),pe=n(173),Ee=function(){var e=Object(u.c)((function(e){return e.signedinUser})),t=Object(u.b)(),n=Object(d.f)();return e?r.a.createElement(me.a,{position:"static"},r.a.createElement(fe.a,null,r.a.createElement(D.a,{display:"flex",flexGrow:1},r.a.createElement(de.a,null,r.a.createElement(pe.a,{component:f.b,to:"/blogs",label:"BLOGS"}),r.a.createElement(pe.a,{component:f.b,to:"/users",label:"USERS"}))),r.a.createElement("span",null,e.name," is logged in"),r.a.createElement("span",null,"    "),r.a.createElement(C.a,{color:"inherit",onClick:function(){window.localStorage.removeItem("loggedUser"),t({type:"LOGOUT"}),n.push("/")}},"logout"))):null},be=function(){return r.a.createElement("h1",null,"Serialize yourself...")},ve=function(){Object(u.c)((function(e){return e.blogs}));var e=Object(u.c)((function(e){return e.signedinUser})),t=Object(u.b)();Object(a.useEffect)((function(){t(function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",data:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),Object(a.useEffect)((function(){t(function(){var e=Object(m.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S();case 2:n=e.sent,t({type:"INIT_USERS",payload:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t]),Object(a.useEffect)((function(){var e=window.localStorage.getItem("loggedUser");if(e){var n=JSON.parse(e);t(x(n)),h.setToken(n.token)}}),[]);return r.a.createElement("div",null,r.a.createElement(f.a,null,r.a.createElement(Ee,null),r.a.createElement(ue,null),r.a.createElement(G.a,null,null===e?r.a.createElement(re,null):r.a.createElement("div",null,r.a.createElement(d.c,null,r.a.createElement(d.a,{path:"/blogs"},r.a.createElement(te,null)),r.a.createElement(d.a,{path:"/users"},r.a.createElement(se,null)),r.a.createElement(d.a,{path:"/"},r.a.createElement(be,null)))))))},ge=n(38),Oe=n(88),he=n(89),ye=Object(ge.combineReducers)({blogs:w,signedinUser:I,notification:k,users:L}),je=Object(ge.createStore)(ye,Object(he.composeWithDevTools)(Object(ge.applyMiddleware)(Oe.a)));l.a.render(r.a.createElement(u.a,{store:je},r.a.createElement(o.a,null),r.a.createElement(ve,null)),document.getElementById("root"))},60:function(e,t,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.a0614556.chunk.js.map